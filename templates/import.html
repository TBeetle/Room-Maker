{% extends 'base.html' %}

{% block title %} Import File {% endblock %}

{% block content %}

<header>
    <h1 class="display-5 fw-bold" style="text-align: center;">LaTeX File Generator</h1>
</header>

    <div class="container px-lg-5 mt-3">
        <div class="p-4 p-lg-5 bg-light rounded-3 text-center" id="drop-zone" style="border: 2px dashed #ccc; max-width: 800px; margin: 0 auto;">
            <div class="m-4 m-lg-5">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="mb-3 mt-4 text-center">
                        <input type="file" class="form-control" id="formFile" name="uploaded_file" style="display: none;">
                        <label for="formFile" id="file-label"></label>
                        <button type="button" class="btn upload-button" onclick="document.getElementById('formFile').click();">Upload</button>
                        <br>
     
                        <div style="padding-top: 0.5rem;">
                            <span style="color: gray;">Or drop file here</span>
                        </div>
                    </div>                    
                    {% if messages %}
                        <ul class="messages">
                            {% for message in messages %}
                                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                            {% endfor %}
                        </ul>
                  
                    {% endif %}
                </div>
            </div>
            <div class="text-center" style="padding-top: 2rem;">
                <button type="submit" class="btn convert-button btn-lg">
                    Convert   <i class="bi bi-arrow-right"></i>
                  </button>
                  
            </div>

            
                </form>
    </div>


<section class="mb-4">
    <div class="container">
        <div class="download-sample-files text-center mt-4">
            <p class="mb-2" style="color: #616161">Download sample input files:</p>
            <div class="btn-group">
                <button type="button" class="btn btn-sm btn-secondary" onclick="window.location.href='{% url 'download-sample-excel' %}'">Excel</button>
                <button type="button" class="btn btn-sm btn-secondary" onclick="window.location.href='{% url 'download-sample-csv' %}'">CSV</button>
                <button type="button" class="btn btn-sm btn-secondary" onclick="window.location.href='{% url 'download-sample-json' %}'">JSON</button>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const dropZone = document.querySelector("#drop-zone"); // Select the drop zone div
        const fileInput = document.querySelector("#formFile"); // Select the file input element
        const fileLabel = document.querySelector("#file-label"); // Select the file label element

        // Function to handle file drop
        function handleFileDrop(event) {
            event.preventDefault(); // Prevent default behavior
            const files = event.dataTransfer.files; // Get the dropped files
            if (files.length > 0) {
                fileInput.files = files; // Update the file input with the dropped files
                fileLabel.textContent = files[0].name; // Update the file label to display the selected file name
            }
            dropZone.classList.remove("dragover"); // Remove the dragover class
        }

        // Event listeners for drag and drop events
        dropZone.addEventListener("dragover", function(event) {
            event.preventDefault(); // Prevent default behavior
            dropZone.classList.add("dragover"); // Add dragover class to visually indicate drop zone
        });

        dropZone.addEventListener("dragenter", function(event) {
            event.preventDefault(); // Prevent default behavior
            dropZone.classList.add("dragover"); // Add dragover class to visually indicate drop zone
        });

        dropZone.addEventListener("dragleave", function(event) {
            event.preventDefault(); // Prevent default behavior
            dropZone.classList.remove("dragover"); // Remove dragover class when leaving drop zone
        });

        dropZone.addEventListener("drop", handleFileDrop); // Add event listener for file drop

        // Optional: Add click event listener to trigger file input click
        fileLabel.addEventListener("click", function() {
            fileInput.click();
        });
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const fileInput = document.querySelector("#formFile"); // Select the file input element
        const fileLabel = document.querySelector("#file-label"); // Select the file label element

        // Function to handle file selection
        function handleFileSelection() {
            const file = fileInput.files[0]; // Get the selected file
            if (file) {
                fileLabel.textContent = file.name; // Update the file label to display the selected file name
            } else {
                fileLabel.textContent = "No file selected"; // Display a message if no file is selected
            }
        }

        // Event listener for file input change event
        fileInput.addEventListener("change", handleFileSelection);

        // Optional: Add click event listener to trigger file input click
        fileLabel.addEventListener("click", function() {
            fileInput.click();
        });
    });
</script>


</body>
</html>

{% endblock %}